<div class="container-fluid">
    <form>
        <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
        <div class="row">
            <div class="col-xs-12 meal-dtld-menu-label text-primary">
                <img src="/static/sources/createMeal/cutlery_menu.png" style="position:relative;bottom:2px"> <strong>{{meal.menu.title}}</strong>
            </div>
            <div class="col-xs-12" style="margin:15px">
                <div class="row" ng-if="meal.menu.description" style="margin-right:0px">
                    Description: <em>{{meal.menu.description}}</em>
                </div>
                <div class="row meal-info-label">
                    <span class="glyphicon glyphicon-map-marker"></span> {{meal.address.town}}, {{meal.address.country}}<span ng-if="meal.address.postalCode"> - {{meal.address.postalCode}}</span>
                </div>
                <div class="row meal-info-label">
                    <span class="glyphicon glyphicon-calendar"></span> {{meal.time |date:'EEEE dd MMMM'}}
                </div>
                <div class="row meal-info-label" ng-if="meal.veggies == true || meal.vegan == true">
                    <img ng-src="/static/sources/vegetarian.png" style="width:14px; height:14px"> <span ng-if="meal.veggies==true">Vegetarian</span><span ng-if="meal.vegan==true">Vegan</span> meal
                </div>
                <div class="row" ng-if="meal.halal == true">
                    <img ng-src="/static/sources/viewMeals/halal-sign.png" style="width:14px; height:14px"> Halal meal
                </div>
                <div class="row" ng-if="meal.kosher == true">
                    <img ng-src="/static/sources/viewMeals/kosher-sign.png" style="width:14px; height:14px"> Kosher meal
                </div>
            </div>
        </div>
        <div class="row meal-dtld-group">
            <div class="meal-label meal-dtld-group-label">Inscription as :</div>
            <div ng-if="errorSubscribe.requestRole.status">
                <div uib-alert class="alert alert-dismissible alert-danger text-center" close="closeAlert()">{{errorSubscribe.requestRole.message}}</div>
            </div>
            <div class="meal-dtld-helpers-label meal-dtld-col">
                <span class="meal-dtld-helpers-position" uib-tooltip="participants" tooltip-trigger="mouseenter" tooltip-placement="top"><img src="/static/sources/multiple-users-silhouette.png" height="18px" width="18px"></span>
                <span class="meal-dtld-helpers-position glyphicon glyphicon-piggy-bank" uib-tooltip="price" tooltip-trigger="mouseenter" tooltip-placement="top" style="font-size:18px"></span>
                <span class="meal-dtld-helpers-position glyphicon glyphicon-time" uib-tooltip="arrival time" tooltip-trigger="mouseenter" tooltip-placement="top" style="font-size:18px"></span>
            </div>
            <uib-accordion close-others="accordionOneAtATime">
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.cooks">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="cook" ng-disabled="!requiredGuests.availablePlaces.cooks" ng-click="status.open1=true">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open1" is-disabled="!requiredGuests.availablePlaces.cooks">
                        <uib-accordion-heading>
                            <div class="meal-dtld-helpers-label">Help cooking
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open1, 'glyphicon-chevron-right': !status.open1}"></i>
                                <span class="meal-dtld-helpers-position">{{meal.detailedInfo.requiredGuests.cooks.nbRquCooks - meal.detailedInfo.requiredGuests.cooks.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.cooks.nbRquCooks}}</span>
                                <span class="meal-dtld-helpers-position text-success">{{meal.currency_symbol}} {{meal.detailedInfo.requiredGuests.cooks.price}}</span>
                                <span class="meal-dtld-helpers-position">{{meal.detailedInfo.requiredGuests.cooks.timeCooking | date:'HH:mm'}}</span>
                            </div>
                        </uib-accordion-heading>
                        <div class="size-12">You have to arrive at <strong>{{meal.detailedInfo.requiredGuests.cooks.timeCooking | date : 'HH:mm'}}</strong> in order to help the host to prepare the meal.</div>
                        <div class="size-12" ng-if="meal.priceUnit != meal.detailedInfo.requiredGuests.cooks.price">The price can vary <strong class="size-15 text-success" ng-bind-html="meal.priceSentence"></strong> according to the inscriptions (<a ui-sref="footer_information_concept" ng-click="cancel()">more info about pricing</a>). You
                            will be informed before the dinner of the final price.</div>
                    </div>
                </div>
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.cleaners">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="cleaner" ng-disabled="!requiredGuests.availablePlaces.cleaners" ng-click="status.open2=true">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open2" is-disabled="!requiredGuests.availablePlaces.cleaners">
                        <uib-accordion-heading>
                            <div class="meal-dtld-helpers-label">Help cleaning
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open2, 'glyphicon-chevron-right': !status.open2}"></i>
                                <span class="meal-dtld-helpers-position">{{meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners - meal.detailedInfo.requiredGuests.cleaners.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners}}</span>
                                <span class="meal-dtld-helpers-position text-success">{{meal.currency_symbol}} {{meal.detailedInfo.requiredGuests.cleaners.price}}</span>
                                <span class="meal-dtld-helpers-position"><span ng-if="meal.detailedInfo.requiredGuests.cleaners.timeCleaning">{{meal.detailedInfo.requiredGuests.cleaners.timeCleaning | date:'HH:mm'}}</span><span ng-if="!meal.detailedInfo.requiredGuests.cleaners.timeCleaning">{{meal.time | date:'HH:mm'}}</span></span>

                            </div>
                        </uib-accordion-heading>
                        <div class="size-12"><span ng-if="meal.detailedInfo.requiredGuests.cleaners.timeCleaning">You have to arrive at <strong>{{meal.detailedInfo.requiredGuests.cleaners.timeCleaning | date : 'HH:mm'}}</strong> in order to help for</span><span ng-if="!meal.detailedInfo.requiredGuests.cleaners.timeCleaning">You will help</span>                            ordering and cleaning what was used for the meal.</div>
                        <div class="size-12" ng-if="meal.priceUnit != meal.detailedInfo.requiredGuests.cleaners.price">The price can vary <strong class="size-15 text-success" ng-bind-html="meal.priceSentence"></strong> according to the inscriptions (<a ui-sref="footer_information_concept" ng-click="cancel()">more info about pricing</a>). You
                            will be informed before the dinner of the final price.</div>
                    </div>
                </div>
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.simpleGuests">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="simpleGuest" ng-disabled="!requiredGuests.availablePlaces.simpleGuests" ng-click="status.open3=true">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open3" is-disabled="!requiredGuests.availablePlaces.simpleGuests">
                        <uib-accordion-heading>
                            <div class="meal-dtld-helpers-label">Simple guest
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open3, 'glyphicon-chevron-right': !status.open3}"></i>
                                <span class="meal-dtld-helpers-position">{{meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests - meal.detailedInfo.requiredGuests.simpleGuests.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests}}</span>
                                <span class="meal-dtld-helpers-position text-success">{{meal.currency_symbol}} {{meal.detailedInfo.requiredGuests.simpleGuests.price}}</span>
                                <span class="meal-dtld-helpers-position">{{meal.time | date:'HH:mm'}}</span>
                            </div>
                        </uib-accordion-heading>
                        <div class="size-12">You help by paying a little bit more : this money will be redistribuated between those who helped to organize the event</div>
                    </div>
                </div>
            </uib-accordion>
        </div>
        <div ng-if="cellphoneValidation==false && isAuthenticated">
            <div class="row meal-dtld-group">
                <div class="meal-label meal-dtld-group-label">Info required <i class="fa fa-info-circle" uib-tooltip="Private information displayed only between participants and host" tooltip-trigger="mouseenter" tooltip-placement="right"></i></div>
            </div>
            <div ng-if="errorSubscribe.cellphone.status">
                <div uib-alert class="alert alert-dismissible alert-danger text-center" close="closeAlert()">{{errorSubscribe.cellphone.message}}</div>
            </div>
            <input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" class="form-control" id="inputCellphone" placeholder="Cellphone" ng-model="user.privateInfo.cellphone">
            <div class="clear20"></div>
        </div>
        <div class="row col-xs-12">
            <div class="small">Do you want to receive updates about the meal on messenger? (recommended)</div>
            <div class="fb-messenger-checkbox" origin="{{origin}}" page_id="{{page_id}}" messenger_app_id="{{app_id}}" user_ref="{{user_ref}}" prechecked="true" allow_login="true" size="small"></div>
        </div>
        <div class="clear10"></div>
        <div class="text-center row">
            <a class="btn" ng-class="{'btn-primary': isAuthenticated, 'btn-facebook': !isAuthenticated}" ng-click="subscribeMealAuth(meal._id, requestRole.name, 'facebook')" ng-if="meal.nbRemainingPlaces>0 && !goToMeal" ng-hide="datasUserForEachMeal(meal).status == 'pending'"
                ng-disabled="checkMealDate() == false"><span ng-if="!isAuthenticated">Sign In with facebook<br/>to participate</span><span ng-if="isAuthenticated">Participate</span></a>
            <a class="btn btn-success" ng-if="goToMeal" ng-click="cancel()" ui-sref="view_my_dtld_meals({myMealId: meal._id})">See the meal</a>
            <button class="btn btn-sm btn-danger" ng-click="unsubscribe()" ng-if="datasUserForEachMeal(meal).status == 'pending'"><strong><span class="glyphicon glyphicon-remove-sign"></span></strong> Cancel my request</button>
            <div ng-if="meal.nbRemainingPlaces<=0  && goToMeal!=true"><strong class="text-danger">The meal is already full!</strong><br><br><span>Please <a class="btn btn-xs btn-facebook" ng-click="auth('facebook', toState)">Sign In</a> if you already subscribed.</span></div>
        </div>
        <div class="clear10"></div>

        <div class="row meal-dtld-group">
            <div class="row" ng-if="meal.detailedInfo.requiredGuests.hosts">
                <div class="meal-label meal-dtld-group-label">Your host:</div>
                <div ng-repeat="participant in meal.users" class="col-sm-6" ng-if="participant.status == 'accepted' && participant.role[0] == 'admin'">
                    <div class="meal-dtld-list-user">
                        <div>
                            <img ng-src="{{participant.picture.data.url}}" style="border-radius:10px;width:75px; height:75px" class="pull-left" alt="User profile picture" />
                            <div style="position:relative; left:10px;">
                                <div>
                                    <a ui-sref="profile({userId: participant._id})" ng-click="cancel()"><strong class="text-info">{{participant.first_name}} {{participant.last_name}}</strong></a>
                                </div>
                                <div class="small" style="padding-top:4px">
                                    <span ng-if="participant.gender"><i class="fa fa-venus-mars"></i> {{participant.gender | capitalizeFirstLetter}}</br></span>
                                    <span ng-if="participant.birthdate"><i class="fa fa-birthday-cake"></i> {{participant.birthdate | ageFilter}} years old</br></span>
                                    <span ng-if="participant.country_of_origin"><i class="fa fa-globe"></i> From {{participant.country_of_origin.name}}</br></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clear10"></div>
                </div>
            </div>
            <div class="row" ng-if="meal.detailedInfo.requiredGuests.cooks.nbRquCooks && meal.detailedInfo.requiredGuests.cooks.nbRquCooks > meal.detailedInfo.requiredGuests.cooks.nbRemainingPlaces">
                <div class="meal-label meal-dtld-group-label">Help cooking:</div>
                <div ng-repeat="participant in meal.users" class="col-sm-6" ng-if="participant.status == 'accepted' && participant.role[0] == 'cook'">
                    <div class="meal-dtld-list-user">
                        <div>
                            <img ng-src="{{participant.picture.data.url}}" style="border-radius:10px;width:75px; height:75px" class="pull-left" alt="User profile picture" />
                            <div style="position:relative; left:10px;">
                                <div>
                                    <a ui-sref="profile({userId: participant._id})" ng-click="cancel()"><strong class="text-info">{{participant.first_name}} {{participant.last_name}}</strong></a>
                                </div>
                                <div class="small" style="padding-top:4px">
                                    <span ng-if="participant.gender"><i class="fa fa-venus-mars"></i> {{participant.gender | capitalizeFirstLetter}}</br></span>
                                    <span ng-if="participant.birthdate"><i class="fa fa-birthday-cake"></i> {{participant.birthdate | ageFilter}} years old</br></span>
                                    <span ng-if="participant.country_of_origin"><i class="fa fa-globe"></i> From {{participant.country_of_origin.name}}</br></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clear10"></div>
                </div>
            </div>
            <div class="row" ng-if="meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners && meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners > meal.detailedInfo.requiredGuests.cleaners.nbRemainingPlaces">
                <div class="meal-label meal-dtld-group-label">Help cleaning:</div>
                <div ng-repeat="participant in meal.users" class="col-sm-6" ng-if="participant.status == 'accepted' && participant.role[0] == 'cleaner'">
                    <div class="meal-dtld-list-user">
                        <div>
                            <img ng-src="{{participant.picture.data.url}}" style="border-radius:10px;width:75px; height:75px" class="pull-left" alt="User profile picture" />
                            <div style="position:relative; left:10px;">
                                <div>
                                    <a ui-sref="profile({userId: participant._id})" ng-click="cancel()"><strong class="text-info">{{participant.first_name}} {{participant.last_name}}</strong></a>
                                </div>
                                <div class="small" style="padding-top:4px">
                                    <span ng-if="participant.gender"><i class="fa fa-venus-mars"></i> {{participant.gender | capitalizeFirstLetter}}</br></span>
                                    <span ng-if="participant.birthdate"><i class="fa fa-birthday-cake"></i> {{participant.birthdate | ageFilter}} years old</br></span>
                                    <span ng-if="participant.country_of_origin"><i class="fa fa-globe"></i> From {{participant.country_of_origin.name}}</br></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clear10"></div>
                </div>
            </div>
            <div class="row" ng-if="meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests && meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests > meal.detailedInfo.requiredGuests.simpleGuests.nbRemainingPlaces">
                <div class="meal-label meal-dtld-group-label">Simple guest:</div>
                <div ng-repeat="participant in meal.users" class="col-sm-6" ng-if="participant.status == 'accepted' && participant.role[0] == 'simpleGuest'">
                    <div class="meal-dtld-list-user">
                        <div>
                            <img ng-src="{{participant.picture.data.url}}" style="border-radius:10px;width:75px; height:75px" class="pull-left" alt="User profile picture" />
                            <div style="position:relative; left:10px;">
                                <div>
                                    <a ui-sref="profile({userId: participant._id})" ng-click="cancel()"><strong class="text-info">{{participant.first_name}} {{participant.last_name}}</strong></a>
                                </div>
                                <div class="small" style="padding-top:4px">
                                    <span ng-if="participant.gender"><i class="fa fa-venus-mars"></i> {{participant.gender | capitalizeFirstLetter}}</br></span>
                                    <span ng-if="participant.birthdate"><i class="fa fa-birthday-cake"></i> {{participant.birthdate | ageFilter}} years old</br></span>
                                    <span ng-if="participant.country_of_origin"><i class="fa fa-globe"></i> From {{participant.country_of_origin.name}}</br></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clear10"></div>
                </div>
            </div>
        </div>
    </form>
</div>