<div class="container-fluid">
    <form>
        <button type="button" class="close" ng-click="cancel()" aria-hidden="true">&times;</button>
        <div class="row">
            <label class="meal-dtld-menu-label">{{meal.menu.title}}</label>
            <div class="col-xs-9 meal-dtld-left">
                <div class="row">
                    <div class="col-xs-12">
                        <div class="row" ng-if="meal.menu.description">
                            <div class="col-xs-12">
                                Description of the meal : {{meal.menu.description}}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="meal-label meal-location">{{meal.address.town}} - {{meal.address.postalCode}}</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-6">
                                <div class="meal-label meal-date">{{meal.time |date:'EEEE dd MMMM'}} </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-3 meal-dtld-right">
                <div ng-style="getStyle()" class="" style="font-size: 12px; width: 100%;top:39%;position:absolute;color: rgba(56, 52, 52, 0.45);font-weight:bold; text-align:center; padding:inherit">{{meal.nbGuests-meal.nbRemainingPlaces}} / {{meal.nbGuests}}</div>
                <div ng-style="getStyle()" style="width:67px;margin:auto">
                    <div round-progress responsive="true" max="meal.nbGuests" current="meal.nbGuests - meal.nbRemainingPlaces" color="#45ccce" bgcolor="#eaeaea" radius="30" stroke="10" rounded="true" duration="800" animation="easeInOutQuart" animation-delay="0"> </div>
                </div>
            </div>
        </div>
        <div class="row meal-dtld-group">
            <div class="meal-label meal-dtld-group-label">Inscription as :</div>
            <div ng-if="errorSubscribe.requestRole.status">
                <div uib-alert class="alert alert-dismissible alert-danger text-center" close="closeAlert()">{{errorSubscribe.requestRole.message}}</div>
            </div>
            <div class="meal-dtld-helpers-label meal-dtld-col">
                <span class="meal-dtld-helpers-places" uib-popover="participants" popover-trigger="mouseenter" popover-placement="top"><img src="/static/sources/multiple-users-silhouette.png" height="18px" width="18px"></span>
                <span class="meal-dtld-helpers-price" uib-popover="price" popover-trigger="mouseenter" popover-placement="top"><img src="/static/sources/banknote.png" height="18px" width="18px"></span>
                <span class="meal-dtld-helpers-places" uib-popover="arrival time" popover-trigger="mouseenter" popover-placement="top"><img src="/static/sources/clock.png" height="18px" width="18px"></span>
            </div>
            <uib-accordion close-others="accordionOneAtATime">
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.cooks">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="cook" ng-disabled="!requiredGuests.availablePlaces.cooks">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open1" is-disabled="!requiredGuests.availablePlaces.cooks">
                        <uib-accordion-heading>
                            <div class="meal-dtld-helpers-label">Help cooking
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open1, 'glyphicon-chevron-right': !status.open1}"></i>
                                <span class="meal-dtld-helpers-places">{{meal.detailedInfo.requiredGuests.cooks.nbRquCooks - meal.detailedInfo.requiredGuests.cooks.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.cooks.nbRquCooks}}</span>
                                <span class="meal-dtld-helpers-price">{{meal.detailedInfo.requiredGuests.cooks.price | currency}}</span>
                                <span class="meal-dtld-helpers-places">{{meal.detailedInfo.requiredGuests.cooks.timeCooking | date:'HH:mm'}}</span>
                            </div>
                        </uib-accordion-heading>
                        <div class="meal-dtld-helpers-description">You come to help the host to prepare the meal. </br>Note: You need to be there at <span class="meal-dtld-helpers-description-time">{{meal.detailedInfo.requiredGuests.cooks.timeCooking | date : 'HH:mm'}}</span>
                        </div>
                    </div>
                </div>
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.cleaners">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="cleaner" ng-disabled="!requiredGuests.availablePlaces.cleaners">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open2" is-disabled="!requiredGuests.availablePlaces.cleaners">
                        <uib-accordion-heading>
                            <div class="meal-dtld-helpers-label">Help cleaning
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open2, 'glyphicon-chevron-right': !status.open2}"></i>
                                <span class="meal-dtld-helpers-places">{{meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners - meal.detailedInfo.requiredGuests.cleaners.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.cleaners.nbRquCleaners}}</span>
                                <span class="meal-dtld-helpers-price">{{meal.detailedInfo.requiredGuests.cleaners.price | currency}}</span>
                                <span class="meal-dtld-helpers-places">{{meal.time | date:'HH:mm'}}</span>
                            </div>
                        </uib-accordion-heading>
                        <div class="meal-dtld-helpers-description">At the end of or during the event, you will help to order and clean what was used to prepare the meal</div>
                    </div>
                </div>
                <div style="overflow:auto" ng-if="meal.detailedInfo.requiredGuests.simpleGuests">
                    <input class="pull-left meal-dtld-helpers-radio" type="radio" ng-model="$parent.requestRole.name" value="simpleGuest" ng-disabled="!requiredGuests.availablePlaces.simpleGuests">
                    <div uib-accordion-group class="panel-default pull-left meal-dtld-helpers" is-open="status.open3" is-disabled="!requiredGuests.availablePlaces.simpleGuests">
                        <uib-accordion-heading>

                            <div class="meal-dtld-helpers-label">Simple guest
                                <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open3, 'glyphicon-chevron-right': !status.open3}"></i>
                                <span class="meal-dtld-helpers-places">{{meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests - meal.detailedInfo.requiredGuests.simpleGuests.nbRemainingPlaces}}/{{meal.detailedInfo.requiredGuests.simpleGuests.nbRquSimpleGuests}}</span>
                                <span class="meal-dtld-helpers-price">{{meal.detailedInfo.requiredGuests.simpleGuests.price | currency}}</span>
                                <span class="meal-dtld-helpers-places">{{meal.time | date:'HH:mm'}}</span>
                            </div>
                        </uib-accordion-heading>
                        <div class="meal-dtld-helpers-description">I help by paying a little bit more : this money will be redistribuated between those who helped to organize the event</div>
                    </div>
                </div>
            </uib-accordion>
        </div>
        <div ng-if="cellphoneValidation==false && isAuthenticated">
            <div class="row meal-dtld-group">
                <div class="meal-label meal-dtld-group-label">Info required :</div>
            </div>
            <div ng-if="errorSubscribe.cellphone.status">
                <div uib-alert class="alert alert-dismissible alert-danger text-center" close="closeAlert()">{{errorSubscribe.cellphone.message}}</div>
            </div>
            <input type="tel" pattern="^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$" class="form-control" id="inputCellphone" placeholder="Cellphone" uib-popover="Private information: displayed only between participants and host"
                popover-trigger="mouseenter" popover-placement="top" ng-model="user.privateInfo.cellphone">
            <div class="clear20"></div>
        </div>
        <div class="row col-xs-12">
            <div class="small">Do you want to receive updates about the meal on messenger? (recommended)</div>
            <div class="fb-messenger-checkbox" origin="{{origin}}" page_id="{{page_id}}" messenger_app_id="{{app_id}}" user_ref="{{user_ref}}" prechecked="true" allow_login="true" size="small"></div>
        </div>
        <div class="clear10"></div>
        <div class="text-center row">
            <a class="btn" ng-class="{'btn-primary': isAuthenticated, 'btn-facebook': !isAuthenticated, 'disabled': meal.detailedInfo.pending==true}" ng-click="subscribeMealAuth(meal._id, requestRole.name, 'facebook')" ng-if="meal.nbRemainingPlaces>0 && !goToMeal"><span ng-if="!isAuthenticated">Sign In with facebook<br/>to participate</span><span ng-if="isAuthenticated">Participate</span></a>
            <a class="btn btn-success" ng-if="goToMeal" ng-click="cancel()" ui-sref="view_my_dtld_meals({myMealId: meal._id})">See the meal</a>
            <div ng-if="meal.nbRemainingPlaces<=0  && (goToMeal=='false' || goToMeal==null)" class="meal-dtld-full-msg">Damn ! The meal is already full</div>
        </div>
        <div class="clear10"></div>

        <div class="row meal-dtld-group">
            <div class="meal-label meal-dtld-group-label">The meal is organized by :</div>
            <div class="meal-dtld-admin-wrapper">
                <a href="{{meal.admin.link}}"><img class="img-circle profilePic meal-dtld-admin-pic" ng-src="{{meal.admin.picture.data.url}}" alt="User profile picture" />
                <div class="meal-admin-name meal-dtld-admin-name">{{meal.admin.first_name}} </br> {{meal.admin.last_name}}</div></a>
            </div>
        </div>
    </form>
</div>